{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Furniture Store">
  <link rel="shortcut icon" href="{% static 'favicon.png' %}">

  <meta name="description" content="{% block meta_description %}ComfyZone pairs artisan craftsmanship with modern ecommerce conveniences so you can furnish every room with confidence.{% endblock %}">
  <meta name="keywords" content="{% block meta_keywords %}comfyzone,furniture,ecommerce,home decor,luxury sofas{% endblock %}">
  <meta name="robots" content="index,follow">
  <link rel="canonical" href="{{ canonical_url }}">
  <meta property="og:site_name" content="{{ site_name }}">
  <meta property="og:title" content="{% block og_title %}ComfyZone | Modern Furniture & Decor{% endblock %}">
  <meta property="og:description" content="{% block og_description %}ComfyZone pairs artisan craftsmanship with modern ecommerce conveniences so you can furnish every room with confidence.{% endblock %}">
  <meta property="og:url" content="{{ canonical_url }}">
  <meta property="og:type" content="{% block og_type %}website{% endblock %}">
  <meta property="og:image" content="{{ site_url }}/static/images/sofa.png">
  <meta name="twitter:card" content="summary_large_image">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <link href="{% static 'css/tiny-slider.css' %}" rel="stylesheet">
  <link href="{% static 'css/style.css' %}" rel="stylesheet">
  <title>{% block title %}ComfyZone Furniture{% endblock %}</title>
</head>

<body>
  <nav class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark" aria-label="Furni navigation bar">
    <div class="container">
      <a class="navbar-brand" href="{% url 'store:home' %}">ComfyZone<span>.</span></a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsFurni">
        <ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
          <li class="nav-item {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
            <a class="nav-link" href="{% url 'store:home' %}">Home</a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'shop' %}active{% endif %}">
            <a class="nav-link" href="{% url 'store:shop' %}">Shop</a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'about' %}active{% endif %}">
            <a class="nav-link" href="{% url 'store:about' %}">About us</a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'services' %}active{% endif %}">
            <a class="nav-link" href="{% url 'store:services' %}">Services</a>
          </li>
          <li class="nav-item {% if request.resolver_match.url_name == 'contact' %}active{% endif %}">
            <a class="nav-link" href="{% url 'store:contact' %}">Contact us</a>
          </li>
        </ul>

        <ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
          {% if user.is_authenticated %}
            <li class="nav-item dropdown dropdown-hover">
              <a class="nav-link dropdown-toggle" href="javascript:void(0);" id="userDropdownAuth" role="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="User account">
                <img src="{% static 'images/user.svg' %}" alt="User account">
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdownAuth">
                {% if user.is_staff %}
                  <li><a class="dropdown-item" href="{% url 'store:admin_product_list' %}">Manage Products</a></li>
                  <li><hr class="dropdown-divider"></li>
                {% endif %}
                <li><a class="dropdown-item" href="{% url 'accounts:profile' %}">Profile</a></li>
                <li><a class="dropdown-item" href="{% url 'orders:history' %}">Order History</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="{% url 'accounts:logout' %}">Logout</a></li>
              </ul>
            </li>
          {% else %}
            <li class="nav-item dropdown dropdown-hover">
              <a class="nav-link dropdown-toggle" href="javascript:void(0);" id="userDropdownGuest" role="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="User account">
                <img src="{% static 'images/user.svg' %}" alt="User account">
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdownGuest">
                <li><a class="dropdown-item" href="{% url 'accounts:login' %}">Login</a></li>
                <li><a class="dropdown-item" href="{% url 'accounts:register' %}">Signup</a></li>
              </ul>
            </li>
          {% endif %}
          <li>
            <a class="nav-link" href="{% url 'cart:view' %}" aria-label="Shopping cart">
              <img src="{% static 'images/cart.svg' %}" alt="Shopping cart">
              {% if cart_count > 0 %}
                <span class="badge bg-primary rounded-pill position-absolute top-0 start-100 translate-middle">{{ cart_count }}</span>
              {% endif %}
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  {% if messages %}
    <div class="container mt-3" id="messages-container">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {% block content %}{% endblock %}

  <footer class="footer-section">
    <div class="container relative">
      <div class="row g-2">
        <div class="col-lg-8">
          <div class="subscription-form">
            <h3 class="d-flex align-items-center">
              <span class="me-1"><img src="{% static 'images/envelope-outline.svg' %}" alt="Image" class="img-fluid"></span>
              <span>Subscribe to Newsletter</span>
            </h3>

            <form action="{% url 'marketing:subscribe' %}" method="post" class="row g-3">
              {% csrf_token %}
              <div class="col-auto">
                <input type="text" name="name" class="form-control" placeholder="Enter your name">
              </div>
              <div class="col-auto">
                <input type="email" name="email" class="form-control" placeholder="Enter your email" required>
              </div>
              <div class="col-auto">
                <button type="submit" class="btn btn-primary">
                  <span class="fa fa-paper-plane"></span>
                </button>
              </div>
              <div class="col-12">
                <div class="form-check">
                  <input type="checkbox" class="form-check-input" id="newsletterConsent" name="consent" value="true" required>
                  <label class="form-check-label small" for="newsletterConsent">
                    I agree to receive emails from ComfyZone. Unsubscribe anytime.
                  </label>
                </div>
              </div>
              <input type="hidden" name="source" value="Footer CTA">
            </form>
          </div>
        </div>
      </div>

      <div class="row g-5 mb-5">
        <div class="col-lg-4">
          <div class="mb-4 footer-logo-wrap"><a href="{% url 'store:home' %}" class="footer-logo">ComfyZone<span>.</span></a></div>
          <p class="mb-4">Bringing you beautifully crafted furniture that transforms your home. Quality pieces, exceptional service, and a commitment to making your space perfect.</p>

          <ul class="list-unstyled custom-social">
            <li><a href="https://www.facebook.com/comfyzonehome" target="_blank" rel="noopener noreferrer nofollow"><span class="fa fa-brands fa-facebook-f"></span></a></li>
            <li><a href="https://x.com/comfyzonehome" target="_blank" rel="noopener noreferrer nofollow"><span class="fa fa-brands fa-twitter"></span></a></li>
            <li><a href="https://www.instagram.com/comfyzonehome" target="_blank" rel="noopener noreferrer nofollow"><span class="fa fa-brands fa-instagram"></span></a></li>
            <li><a href="https://www.linkedin.com/company/comfyzone" target="_blank" rel="noopener noreferrer nofollow"><span class="fa fa-brands fa-linkedin"></span></a></li>
          </ul>
        </div>

        <div class="col-lg-8">
          <div class="row links-wrap">
            <div class="col-6 col-sm-6 col-md-3">
              <ul class="list-unstyled">
                <li><a href="{% url 'store:about' %}">About us</a></li>
                <li><a href="{% url 'store:services' %}">Services</a></li>
                <li><a href="{% url 'store:contact' %}">Contact us</a></li>
              </ul>
            </div>

            <div class="col-6 col-sm-6 col-md-3">
              <ul class="list-unstyled">
                <li><a href="{% url 'store:contact' %}">Support</a></li>
                <li><a href="{% url 'store:services' %}">Knowledge base</a></li>
                <li><a href="{% url 'store:contact' %}">Live chat</a></li>
              </ul>
            </div>

            <div class="col-6 col-sm-6 col-md-3">
              <ul class="list-unstyled">
                <li><a href="{% url 'store:about' %}">Jobs</a></li>
                <li><a href="{% url 'store:about' %}">Our team</a></li>
                <li><a href="{% url 'store:about' %}">Leadership</a></li>
                <li><a href="{% url 'store:privacy' %}">Privacy Policy</a></li>
              </ul>
            </div>

            <div class="col-6 col-sm-6 col-md-3">
              <ul class="list-unstyled">
                <li><a href="{% url 'store:shop' %}">Shop</a></li>
                <li><a href="{% url 'store:shop' %}">Products</a></li>
                <li><a href="{% url 'cart:view' %}">Cart</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="border-top copyright">
        <div class="row pt-4">
          <div class="col-lg-6">
            <p class="mb-2 text-center text-lg-start">
              Copyright &copy;{% now "Y" %}. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co" target="_blank" rel="noopener noreferrer">Untree.co</a> Distributed By <a href="https://themewagon.com" target="_blank" rel="noopener noreferrer">ThemeWagon</a>
            </p>
          </div>

          <div class="col-lg-6 text-center text-lg-end">
            <ul class="list-unstyled d-inline-flex ms-auto">
              <li class="me-4"><a href="{% url 'store:terms' %}">Terms &amp; Conditions</a></li>
              <li><a href="{% url 'store:privacy' %}">Privacy Policy</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="sofa-img">
        <img src="{% static 'images/sofa.png' %}" alt="Image" class="img-fluid">
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script src="{% static 'js/tiny-slider.js' %}"></script>
  <script src="{% static 'js/custom.js' %}"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var dropdownHovers = document.querySelectorAll('.dropdown-hover');
      
      dropdownHovers.forEach(function(dropdown) {
        var toggle = dropdown.querySelector('.dropdown-toggle');
        var menu = dropdown.querySelector('.dropdown-menu');
        var timeout;
        
        dropdown.addEventListener('mouseenter', function() {
          clearTimeout(timeout);
          if (typeof bootstrap !== 'undefined') {
            var bsDropdown = bootstrap.Dropdown.getOrCreateInstance(toggle);
            if (!bsDropdown._isShown()) {
              bsDropdown.show();
            }
          } else {
            menu.classList.add('show');
            toggle.setAttribute('aria-expanded', 'true');
          }
        });
        
        dropdown.addEventListener('mouseleave', function() {
          timeout = setTimeout(function() {
            if (typeof bootstrap !== 'undefined') {
              var bsDropdown = bootstrap.Dropdown.getInstance(toggle);
              if (bsDropdown && bsDropdown._isShown()) {
                bsDropdown.hide();
              }
            } else {
              menu.classList.remove('show');
              toggle.setAttribute('aria-expanded', 'false');
            }
          }, 200);
        });
        
        toggle.addEventListener('click', function(e) {
          e.preventDefault();
        });
      });
    });
    
    (function() {
      function cleanHash() {
        if (window.location.hash === '#') {
          history.replaceState(null, null, window.location.pathname + window.location.search);
        }
      }
      
      window.addEventListener('hashchange', cleanHash);
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', cleanHash);
      } else {
        cleanHash();
      }
    })();
    
    document.addEventListener('DOMContentLoaded', function() {
      var messagesContainer = document.getElementById('messages-container');
      if (messagesContainer) {
        var alerts = messagesContainer.querySelectorAll('.alert');
        
        function hideContainerIfEmpty() {
          var visibleAlerts = Array.from(alerts).filter(function(alert) {
            return alert.classList.contains('show') || 
                   (!alert.classList.contains('fade') && alert.offsetHeight > 0);
          });
          
          if (visibleAlerts.length === 0) {
            setTimeout(function() {
              messagesContainer.style.display = 'none';
              messagesContainer.style.margin = '0';
              messagesContainer.style.padding = '0';
              messagesContainer.style.height = '0';
            }, 350);
          }
        }
        
        alerts.forEach(function(alert) {
          alert.addEventListener('closed.bs.alert', function() {
            hideContainerIfEmpty();
          });
        });
      }
    });
  </script>
  {% block extra_js %}{% endblock %}
</body>
</html>

